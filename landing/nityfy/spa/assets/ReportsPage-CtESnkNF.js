import{o as C,O as i,m as F,n as B,p as a,q as t,f as o,Q as I,X as l,z as d,a8 as u,r as s}from"./index-BCoBQOFT.js";import{Q as N}from"./QPage-DNQfSVvF.js";import{m as Q}from"./vue3-apexcharts-jBJOZXzt.js";import{u as R}from"./currency-FmnwYlLu.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-D5GkNzM3.js";const P={class:"row items-center justify-between q-mb-lg"},j={class:"row q-col-gutter-md q-mb-lg"},E={class:"col-12 col-md-3"},T={class:"text-h4 text-weight-bold q-mt-xs"},z={class:"text-caption text-grey-6"},J={class:"col-12 col-md-3"},L={class:"text-h4 text-weight-bold q-mt-xs"},V={class:"col-12 col-md-3"},W={class:"text-h4 text-weight-bold q-mt-xs"},X={class:"col-12 col-md-3"},$={class:"text-h4 text-weight-bold q-mt-xs"},G={class:"row q-col-gutter-md"},H={class:"col-12 col-md-8"},K={class:"col-12 col-md-4"},U={__name:"ReportsPage",setup(Y){const m=R(),x=Q,p=s(!1),b=s(0),O=s(0),f=s(0),v=s(0),D=s(0),_=s([{name:"Income",data:[0,0,0,0,0,0]},{name:"Expenses",data:[0,0,0,0,0,0]}]),h=s({chart:{type:"bar",toolbar:{show:!1}},plotOptions:{bar:{borderRadius:4,horizontal:!1,columnWidth:"55%"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{categories:["Aug","Sep","Oct","Nov","Dec","Jan"]},colors:["#34D399","#EF4444"],fill:{opacity:1},tooltip:{y:{formatter:r=>m.format(r)}}}),w=s([]),g=s({chart:{type:"donut"},labels:[],colors:["#60A5FA","#34D399","#FBBF24","#F87171","#A78BFA"],legend:{position:"bottom"}});C(()=>{y()});const y=async()=>{p.value=!0;const{count:r}=await i.from("students").select("*",{count:"exact",head:!0}).eq("status","Active");b.value=r||0;const e=new Date().toISOString().slice(0,10),{count:k}=await i.from("attendance").select("*",{count:"exact",head:!0}).eq("date",e).eq("status","Present");f.value=k||0;const A=new Date().toISOString().slice(0,7),{data:q}=await i.from("payments").select("amount").like("payment_date",`${A}%`);v.value=q?q.reduce((n,c)=>n+Number(c.amount),0):0,h.value={...h.value,xaxis:{categories:["Sep","Oct","Nov","Dec","Jan","Feb"]}},_.value[0].data=[15e3,22e3,18e3,25e3,3e4,v.value];const{data:S}=await i.from("students").select("grade");if(S){const n={};S.forEach(c=>{n[c.grade]=(n[c.grade]||0)+1}),g.value={...g.value,labels:Object.keys(n)},w.value=Object.values(n)}p.value=!1};return(r,e)=>(F(),B(N,{class:"q-pa-lg"},{default:a(()=>[t("div",P,[e[0]||(e[0]=t("div",null,[t("h1",{class:"text-h5 text-weight-bold q-my-none text-dark"},"Analytics & Reports"),t("p",{class:"text-grey-6 q-mt-xs q-mb-none"},"Overview of system health and performance.")],-1)),t("div",null,[o(I,{unelevated:"",icon:"refresh",color:"grey-3","text-color":"dark",label:"Refresh Data",onClick:y,loading:p.value},null,8,["loading"])])]),t("div",j,[t("div",E,[o(l,{class:"no-shadow border-gray q-pa-md bg-blue-1 text-blue-9"},{default:a(()=>[e[1]||(e[1]=t("div",{class:"text-caption text-uppercase text-weight-bold"},"Total Students",-1)),t("div",T,d(b.value),1),t("div",z,"+"+d(O.value)+" this month",1)]),_:1})]),t("div",J,[o(l,{class:"no-shadow border-gray q-pa-md bg-green-1 text-green-9"},{default:a(()=>[e[2]||(e[2]=t("div",{class:"text-caption text-uppercase text-weight-bold"},"Total Check-ins (Today)",-1)),t("div",L,d(f.value),1)]),_:1})]),t("div",V,[o(l,{class:"no-shadow border-gray q-pa-md bg-orange-1 text-orange-9"},{default:a(()=>[e[3]||(e[3]=t("div",{class:"text-caption text-uppercase text-weight-bold"},"Monthly Income",-1)),t("div",W,d(u(m).format(v.value)),1)]),_:1})]),t("div",X,[o(l,{class:"no-shadow border-gray q-pa-md bg-red-1 text-red-9"},{default:a(()=>[e[4]||(e[4]=t("div",{class:"text-caption text-uppercase text-weight-bold"},"Outstanding Dues",-1)),t("div",$,d(u(m).format(D.value)),1)]),_:1})])]),t("div",G,[t("div",H,[o(l,{class:"no-shadow border-gray q-pa-md"},{default:a(()=>[e[5]||(e[5]=t("div",{class:"text-h6 q-mb-md"},"Financial Overview (Last 6 Months)",-1)),o(u(x),{type:"bar",height:"300",options:h.value,series:_.value},null,8,["options","series"])]),_:1})]),t("div",K,[o(l,{class:"no-shadow border-gray q-pa-md"},{default:a(()=>[e[6]||(e[6]=t("div",{class:"text-h6 q-mb-md"},"Student Distribution",-1)),o(u(x),{type:"donut",height:"300",options:g.value,series:w.value},null,8,["options","series"])]),_:1})])])]),_:1}))}},nt=M(U,[["__scopeId","data-v-1c6628b2"]]);export{nt as default};
