import{d as fe,h as N,o as we,a5 as Re,F as Ce,r as Q,c as X,u as Pe,a6 as Ae,O as J,w as Ne,m as q,n as ee,p as w,q as y,f,Q as T,X as te,z as A,D as $,v as V,S as le,U as Ie,W as ie,Y as Z,P as se,a7 as ue,x as xe,N as Qe,y as de,B as ke,C as De}from"./index-BCoBQOFT.js";import{Q as Te,a as ce}from"./QTable-Dv_xctJK.js";import{Q as ze}from"./QBadge-CD0MS9Rg.js";import{Q as oe,a as ae}from"./QItem-Wb4A_Ad7.js";import{Q as he}from"./QList-TwHTGU55.js";import{Q as Le}from"./QMenu-CRQWq3Fk.js";import{Q as me}from"./QSelect-DZMeRPTx.js";import{Q as Be}from"./QFile-C9mUrIyq.js";import{Q as ge}from"./QItemLabel-djxoAbwS.js";import{Q as Ue}from"./QScrollArea-DpvqNk2s.js";import{Q as Fe}from"./QPage-DNQfSVvF.js";import{C as Y}from"./ClosePopup-DoFqAVUY.js";import{u as Oe}from"./use-quasar-DuPF83ky.js";import{e as pe}from"./export-file-DU7gsD6D.js";import{_ as qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QLinearProgress-DcUDM4wH.js";import"./position-engine-BGz6yeZ8.js";import"./QChip-B9sWOFsV.js";import"./format-CoaQEihs.js";import"./QResizeObserver-CLJoVRmi.js";import"./QScrollObserver-B5hpTMde.js";import"./TouchPan-DDYz_H52.js";import"./touch-BjYP5sR0.js";var L=function(){return L=Object.assign||function(v){for(var h,d=1,m=arguments.length;d<m;d++){h=arguments[d];for(var c in h)Object.prototype.hasOwnProperty.call(h,c)&&(v[c]=h[c])}return v},L.apply(this,arguments)};var K;(function(o){var v=(function(){function r(e,t,a,n){if(this.version=e,this.errorCorrectionLevel=t,this.modules=[],this.isFunction=[],e<r.MIN_VERSION||e>r.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=e*4+17;for(var i=[],s=0;s<this.size;s++)i.push(!1);for(var s=0;s<this.size;s++)this.modules.push(i.slice()),this.isFunction.push(i.slice());this.drawFunctionPatterns();var p=this.addEccAndInterleave(a);if(this.drawCodewords(p),n==-1)for(var S=1e9,s=0;s<8;s++){this.applyMask(s),this.drawFormatBits(s);var b=this.getPenaltyScore();b<S&&(n=s,S=b),this.applyMask(s)}m(0<=n&&n<=7),this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}return r.encodeText=function(e,t){var a=o.QrSegment.makeSegments(e);return r.encodeSegments(a,t)},r.encodeBinary=function(e,t){var a=o.QrSegment.makeBytes(e);return r.encodeSegments([a],t)},r.encodeSegments=function(e,t,a,n,i,s){if(a===void 0&&(a=1),n===void 0&&(n=40),i===void 0&&(i=-1),s===void 0&&(s=!0),!(r.MIN_VERSION<=a&&a<=n&&n<=r.MAX_VERSION)||i<-1||i>7)throw new RangeError("Invalid value");var p,S;for(p=a;;p++){var b=r.getNumDataCodewords(p,t)*8,P=c.getTotalBits(e,p);if(P<=b){S=P;break}if(p>=n)throw new RangeError("Data too long")}for(var E=0,R=[r.Ecc.MEDIUM,r.Ecc.QUARTILE,r.Ecc.HIGH];E<R.length;E++){var M=R[E];s&&S<=r.getNumDataCodewords(p,M)*8&&(t=M)}for(var g=[],I=0,x=e;I<x.length;I++){var k=x[I];h(k.mode.modeBits,4,g),h(k.numChars,k.mode.numCharCountBits(p),g);for(var B=0,D=k.getData();B<D.length;B++){var j=D[B];g.push(j)}}m(g.length==S);var O=r.getNumDataCodewords(p,t)*8;m(g.length<=O),h(0,Math.min(4,O-g.length),g),h(0,(8-g.length%8)%8,g),m(g.length%8==0);for(var U=236;g.length<O;U^=253)h(U,8,g);for(var F=[];F.length*8<g.length;)F.push(0);return g.forEach(function(C,l){return F[l>>>3]|=C<<7-(l&7)}),new r(p,t,F,i)},r.prototype.getModule=function(e,t){return 0<=e&&e<this.size&&0<=t&&t<this.size&&this.modules[t][e]},r.prototype.getModules=function(){return this.modules},r.prototype.drawFunctionPatterns=function(){for(var e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);for(var t=this.getAlignmentPatternPositions(),a=t.length,e=0;e<a;e++)for(var n=0;n<a;n++)e==0&&n==0||e==0&&n==a-1||e==a-1&&n==0||this.drawAlignmentPattern(t[e],t[n]);this.drawFormatBits(0),this.drawVersion()},r.prototype.drawFormatBits=function(e){for(var t=this.errorCorrectionLevel.formatBits<<3|e,a=t,n=0;n<10;n++)a=a<<1^(a>>>9)*1335;var i=(t<<10|a)^21522;m(i>>>15==0);for(var n=0;n<=5;n++)this.setFunctionModule(8,n,d(i,n));this.setFunctionModule(8,7,d(i,6)),this.setFunctionModule(8,8,d(i,7)),this.setFunctionModule(7,8,d(i,8));for(var n=9;n<15;n++)this.setFunctionModule(14-n,8,d(i,n));for(var n=0;n<8;n++)this.setFunctionModule(this.size-1-n,8,d(i,n));for(var n=8;n<15;n++)this.setFunctionModule(8,this.size-15+n,d(i,n));this.setFunctionModule(8,this.size-8,!0)},r.prototype.drawVersion=function(){if(!(this.version<7)){for(var e=this.version,t=0;t<12;t++)e=e<<1^(e>>>11)*7973;var a=this.version<<12|e;m(a>>>18==0);for(var t=0;t<18;t++){var n=d(a,t),i=this.size-11+t%3,s=Math.floor(t/3);this.setFunctionModule(i,s,n),this.setFunctionModule(s,i,n)}}},r.prototype.drawFinderPattern=function(e,t){for(var a=-4;a<=4;a++)for(var n=-4;n<=4;n++){var i=Math.max(Math.abs(n),Math.abs(a)),s=e+n,p=t+a;0<=s&&s<this.size&&0<=p&&p<this.size&&this.setFunctionModule(s,p,i!=2&&i!=4)}},r.prototype.drawAlignmentPattern=function(e,t){for(var a=-2;a<=2;a++)for(var n=-2;n<=2;n++)this.setFunctionModule(e+n,t+a,Math.max(Math.abs(n),Math.abs(a))!=1)},r.prototype.setFunctionModule=function(e,t,a){this.modules[t][e]=a,this.isFunction[t][e]=!0},r.prototype.addEccAndInterleave=function(e){var t=this.version,a=this.errorCorrectionLevel;if(e.length!=r.getNumDataCodewords(t,a))throw new RangeError("Invalid argument");for(var n=r.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][t],i=r.ECC_CODEWORDS_PER_BLOCK[a.ordinal][t],s=Math.floor(r.getNumRawDataModules(t)/8),p=n-s%n,S=Math.floor(s/n),b=[],P=r.reedSolomonComputeDivisor(i),E=0,R=0;E<n;E++){var M=e.slice(R,R+S-i+(E<p?0:1));R+=M.length;var g=r.reedSolomonComputeRemainder(M,P);E<p&&M.push(0),b.push(M.concat(g))}for(var I=[],x=function(k){b.forEach(function(B,D){(k!=S-i||D>=p)&&I.push(B[k])})},E=0;E<b[0].length;E++)x(E);return m(I.length==s),I},r.prototype.drawCodewords=function(e){if(e.length!=Math.floor(r.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var t=0,a=this.size-1;a>=1;a-=2){a==6&&(a=5);for(var n=0;n<this.size;n++)for(var i=0;i<2;i++){var s=a-i,p=(a+1&2)==0,S=p?this.size-1-n:n;!this.isFunction[S][s]&&t<e.length*8&&(this.modules[S][s]=d(e[t>>>3],7-(t&7)),t++)}}m(t==e.length*8)},r.prototype.applyMask=function(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(var t=0;t<this.size;t++)for(var a=0;a<this.size;a++){var n=void 0;switch(e){case 0:n=(a+t)%2==0;break;case 1:n=t%2==0;break;case 2:n=a%3==0;break;case 3:n=(a+t)%3==0;break;case 4:n=(Math.floor(a/3)+Math.floor(t/2))%2==0;break;case 5:n=a*t%2+a*t%3==0;break;case 6:n=(a*t%2+a*t%3)%2==0;break;case 7:n=((a+t)%2+a*t%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[t][a]&&n&&(this.modules[t][a]=!this.modules[t][a])}},r.prototype.getPenaltyScore=function(){for(var e=0,t=0;t<this.size;t++){for(var a=!1,n=0,i=[0,0,0,0,0,0,0],s=0;s<this.size;s++)this.modules[t][s]==a?(n++,n==5?e+=r.PENALTY_N1:n>5&&e++):(this.finderPenaltyAddHistory(n,i),a||(e+=this.finderPenaltyCountPatterns(i)*r.PENALTY_N3),a=this.modules[t][s],n=1);e+=this.finderPenaltyTerminateAndCount(a,n,i)*r.PENALTY_N3}for(var s=0;s<this.size;s++){for(var a=!1,p=0,i=[0,0,0,0,0,0,0],t=0;t<this.size;t++)this.modules[t][s]==a?(p++,p==5?e+=r.PENALTY_N1:p>5&&e++):(this.finderPenaltyAddHistory(p,i),a||(e+=this.finderPenaltyCountPatterns(i)*r.PENALTY_N3),a=this.modules[t][s],p=1);e+=this.finderPenaltyTerminateAndCount(a,p,i)*r.PENALTY_N3}for(var t=0;t<this.size-1;t++)for(var s=0;s<this.size-1;s++){var S=this.modules[t][s];S==this.modules[t][s+1]&&S==this.modules[t+1][s]&&S==this.modules[t+1][s+1]&&(e+=r.PENALTY_N2)}for(var b=0,P=0,E=this.modules;P<E.length;P++){var R=E[P];b=R.reduce(function(I,x){return I+(x?1:0)},b)}var M=this.size*this.size,g=Math.ceil(Math.abs(b*20-M*10)/M)-1;return m(0<=g&&g<=9),e+=g*r.PENALTY_N4,m(0<=e&&e<=2568888),e},r.prototype.getAlignmentPatternPositions=function(){if(this.version==1)return[];for(var e=Math.floor(this.version/7)+2,t=Math.floor((this.version*8+e*3+5)/(e*4-4))*2,a=[6],n=this.size-7;a.length<e;n-=t)a.splice(1,0,n);return a},r.getNumRawDataModules=function(e){if(e<r.MIN_VERSION||e>r.MAX_VERSION)throw new RangeError("Version number out of range");var t=(16*e+128)*e+64;if(e>=2){var a=Math.floor(e/7)+2;t-=(25*a-10)*a-55,e>=7&&(t-=36)}return m(208<=t&&t<=29648),t},r.getNumDataCodewords=function(e,t){return Math.floor(r.getNumRawDataModules(e)/8)-r.ECC_CODEWORDS_PER_BLOCK[t.ordinal][e]*r.NUM_ERROR_CORRECTION_BLOCKS[t.ordinal][e]},r.reedSolomonComputeDivisor=function(e){if(e<1||e>255)throw new RangeError("Degree out of range");for(var t=[],a=0;a<e-1;a++)t.push(0);t.push(1);for(var n=1,a=0;a<e;a++){for(var i=0;i<t.length;i++)t[i]=r.reedSolomonMultiply(t[i],n),i+1<t.length&&(t[i]^=t[i+1]);n=r.reedSolomonMultiply(n,2)}return t},r.reedSolomonComputeRemainder=function(e,t){for(var a=t.map(function(S){return 0}),n=function(S){var b=S^a.shift();a.push(0),t.forEach(function(P,E){return a[E]^=r.reedSolomonMultiply(P,b)})},i=0,s=e;i<s.length;i++){var p=s[i];n(p)}return a},r.reedSolomonMultiply=function(e,t){if(e>>>8||t>>>8)throw new RangeError("Byte out of range");for(var a=0,n=7;n>=0;n--)a=a<<1^(a>>>7)*285,a^=(t>>>n&1)*e;return m(a>>>8==0),a},r.prototype.finderPenaltyCountPatterns=function(e){var t=e[1];m(t<=this.size*3);var a=t>0&&e[2]==t&&e[3]==t*3&&e[4]==t&&e[5]==t;return(a&&e[0]>=t*4&&e[6]>=t?1:0)+(a&&e[6]>=t*4&&e[0]>=t?1:0)},r.prototype.finderPenaltyTerminateAndCount=function(e,t,a){return e&&(this.finderPenaltyAddHistory(t,a),t=0),t+=this.size,this.finderPenaltyAddHistory(t,a),this.finderPenaltyCountPatterns(a)},r.prototype.finderPenaltyAddHistory=function(e,t){t[0]==0&&(e+=this.size),t.pop(),t.unshift(e)},r.MIN_VERSION=1,r.MAX_VERSION=40,r.PENALTY_N1=3,r.PENALTY_N2=3,r.PENALTY_N3=40,r.PENALTY_N4=10,r.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],r.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],r})();o.QrCode=v;function h(r,e,t){if(e<0||e>31||r>>>e)throw new RangeError("Value out of range");for(var a=e-1;a>=0;a--)t.push(r>>>a&1)}function d(r,e){return(r>>>e&1)!=0}function m(r){if(!r)throw new Error("Assertion error")}var c=(function(){function r(e,t,a){if(this.mode=e,this.numChars=t,this.bitData=a,t<0)throw new RangeError("Invalid argument");this.bitData=a.slice()}return r.makeBytes=function(e){for(var t=[],a=0,n=e;a<n.length;a++){var i=n[a];h(i,8,t)}return new r(r.Mode.BYTE,e.length,t)},r.makeNumeric=function(e){if(!r.isNumeric(e))throw new RangeError("String contains non-numeric characters");for(var t=[],a=0;a<e.length;){var n=Math.min(e.length-a,3);h(parseInt(e.substring(a,a+n),10),n*3+1,t),a+=n}return new r(r.Mode.NUMERIC,e.length,t)},r.makeAlphanumeric=function(e){if(!r.isAlphanumeric(e))throw new RangeError("String contains unencodable characters in alphanumeric mode");var t=[],a;for(a=0;a+2<=e.length;a+=2){var n=r.ALPHANUMERIC_CHARSET.indexOf(e.charAt(a))*45;n+=r.ALPHANUMERIC_CHARSET.indexOf(e.charAt(a+1)),h(n,11,t)}return a<e.length&&h(r.ALPHANUMERIC_CHARSET.indexOf(e.charAt(a)),6,t),new r(r.Mode.ALPHANUMERIC,e.length,t)},r.makeSegments=function(e){return e==""?[]:r.isNumeric(e)?[r.makeNumeric(e)]:r.isAlphanumeric(e)?[r.makeAlphanumeric(e)]:[r.makeBytes(r.toUtf8ByteArray(e))]},r.makeEci=function(e){var t=[];if(e<0)throw new RangeError("ECI assignment value out of range");if(e<128)h(e,8,t);else if(e<16384)h(2,2,t),h(e,14,t);else if(e<1e6)h(6,3,t),h(e,21,t);else throw new RangeError("ECI assignment value out of range");return new r(r.Mode.ECI,0,t)},r.isNumeric=function(e){return r.NUMERIC_REGEX.test(e)},r.isAlphanumeric=function(e){return r.ALPHANUMERIC_REGEX.test(e)},r.prototype.getData=function(){return this.bitData.slice()},r.getTotalBits=function(e,t){for(var a=0,n=0,i=e;n<i.length;n++){var s=i[n],p=s.mode.numCharCountBits(t);if(s.numChars>=1<<p)return 1/0;a+=4+p+s.bitData.length}return a},r.toUtf8ByteArray=function(e){e=encodeURI(e);for(var t=[],a=0;a<e.length;a++)e.charAt(a)!="%"?t.push(e.charCodeAt(a)):(t.push(parseInt(e.substring(a+1,a+3),16)),a+=2);return t},r.NUMERIC_REGEX=/^[0-9]*$/,r.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,r.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",r})();o.QrSegment=c})(K||(K={}));(function(o){(function(v){var h=(function(){function d(m,c){this.ordinal=m,this.formatBits=c}return d.LOW=new d(0,1),d.MEDIUM=new d(1,0),d.QUARTILE=new d(2,3),d.HIGH=new d(3,2),d})();v.Ecc=h})(o.QrCode||(o.QrCode={}))})(K||(K={}));(function(o){(function(v){var h=(function(){function d(m,c){this.modeBits=m,this.numBitsCharCount=c}return d.prototype.numCharCountBits=function(m){return this.numBitsCharCount[Math.floor((m+7)/17)]},d.NUMERIC=new d(1,[10,12,14]),d.ALPHANUMERIC=new d(2,[9,11,13]),d.BYTE=new d(4,[8,16,16]),d.KANJI=new d(8,[8,10,12]),d.ECI=new d(7,[0,0,0]),d})();v.Mode=h})(o.QrSegment||(o.QrSegment={}))})(K||(K={}));var re=K,ye="L",Ve=100,Ee=0,Ge=.1,He=2,Se={L:re.QrCode.Ecc.LOW,M:re.QrCode.Ecc.MEDIUM,Q:re.QrCode.Ecc.QUARTILE,H:re.QrCode.Ecc.HIGH},$e=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})();function be(o){return o in Se}function _e(o,v){v===void 0&&(v=0);var h="";return o.forEach(function(d,m){var c=null;d.forEach(function(r,e){if(!r&&c!==null){h+="M".concat(c+v," ").concat(m+v,"h").concat(e-c,"v1H").concat(c+v,"z"),c=null;return}if(e===d.length-1){if(!r)return;c===null?h+="M".concat(e+v,",").concat(m+v," h1v1H").concat(e+v,"z"):h+="M".concat(c+v,",").concat(m+v," h").concat(e+1-c,"v1H").concat(c+v,"z");return}r&&c===null&&(c=e)})}),h}function Ye(o,v,h,d){var m=d.width,c=d.height,r=d.x,e=d.y,t=o.length+h*2,a=Math.floor(v*Ge),n=t/v,i=(m||a)*n,s=(c||a)*n,p=r==null?o.length/2-i/2:r*n,S=e==null?o.length/2-s/2:e*n,b=(d.borderRadius||0)*n,P=null;if(d.excavate){var E=Math.floor(p),R=Math.floor(S),M=Math.ceil(i+p-E),g=Math.ceil(s+S-R);P={x:E,y:R,w:M,h:g}}return{x:p,y:S,h:s,w:i,borderRadius:b,excavation:P}}function Me(o){var v=X(function(){var e;return((e=o.margin)!==null&&e!==void 0?e:Ee)>>>0}),h=X(function(){var e=be(o.level)?o.level:ye;return re.QrCode.encodeText(o.value,Se[e]).getModules()}),d=X(function(){return h.value.length+v.value*2}),m=X(function(){return _e(h.value,v.value)}),c=X(function(){if(!o.imageSettings.src)return{x:0,y:0,width:0,height:0,borderRadius:0};var e=Ye(h.value,o.size,v.value,o.imageSettings);return{x:e.x+v.value,y:e.y+v.value,width:e.w,height:e.h,borderRadius:e.borderRadius}}),r=X(function(){if(!o.imageSettings.excavate||!o.imageSettings.src)return null;var e=He/(o.size/d.value);return{x:c.value.x-e,y:c.value.y-e,width:c.value.width+e*2,height:c.value.height+e*2,borderRadius:c.value.borderRadius}});return{margin:v,numCells:d,cells:h,fgPath:m,imageProps:c,imageBorderProps:r}}var ve={value:{type:String,required:!0,default:""},size:{type:Number,default:Ve},level:{type:String,default:ye,validator:function(o){return be(o)}},background:{type:String,default:"#fff"},foreground:{type:String,default:"#000"},margin:{type:Number,required:!1,default:Ee},imageSettings:{type:Object,required:!1,default:function(){return{}}},gradient:{type:Boolean,required:!1,default:!1},gradientType:{type:String,required:!1,default:"linear",validator:function(o){return["linear","radial"].indexOf(o)>-1}},gradientStartColor:{type:String,required:!1,default:"#000"},gradientEndColor:{type:String,required:!1,default:"#fff"}},Ke=L(L({},ve),{renderAs:{type:String,required:!1,default:"canvas",validator:function(o){return["canvas","svg"].indexOf(o)>-1}}}),We=fe({name:"QRCodeSvg",props:ve,setup:function(o){var v=Me(o),h=v.numCells,d=v.fgPath,m=v.imageProps,c=v.imageBorderProps,r="qrcode.vue-gradient",e=function(){if(!o.gradient)return null;var n=o.gradientType==="linear"?{x1:"0%",y1:"0%",x2:"100%",y2:"100%"}:{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"};return N(o.gradientType==="linear"?"linearGradient":"radialGradient",L({id:r},n),[N("stop",{offset:"0%",style:{stopColor:o.gradientStartColor}}),N("stop",{offset:"100%",style:{stopColor:o.gradientEndColor}})])},t="qrcode.vue-logo-clip-path",a=function(){var n=m.value.borderRadius;return!o.imageSettings.src||n<=0?null:N("clipPath",{id:t},[N("rect",{x:m.value.x,y:m.value.y,width:m.value.width,height:m.value.height,rx:n,ry:n})])};return function(){return N("svg",{width:o.size,height:o.size,"shape-rendering":"crispEdges",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(h.value," ").concat(h.value)},[N("defs",{},[e(),a()]),N("rect",{width:"100%",height:"100%",fill:o.background}),N("path",{fill:o.gradient?"url(#".concat(r,")"):o.foreground,d:d.value}),c.value&&N("rect",{x:c.value.x,y:c.value.y,width:c.value.width,height:c.value.height,fill:o.background,rx:c.value.borderRadius,ry:c.value.borderRadius}),o.imageSettings.src&&N("image",L(L({href:o.imageSettings.src},m.value),m.value.borderRadius>0?{"clip-path":"url(#".concat(t,")")}:{}))])}}}),Xe=fe({name:"QRCodeCanvas",props:ve,setup:function(o,v){var h=Me(o),d=h.margin,m=h.cells,c=h.numCells,r=h.imageProps,e=h.imageBorderProps,t=Q(null),a=Q(null),n=function(){var s=o.size,p=o.background,S=o.foreground,b=o.gradient,P=o.gradientType,E=o.gradientStartColor,R=o.gradientEndColor,M=t.value;if(M){var g=M.getContext("2d");if(g){var I=m.value,x=a.value,k=typeof window<"u"&&window.devicePixelRatio||1,B=s/c.value*k;if(M.height=M.width=s*k,g.scale(B,B),g.fillStyle=p,g.fillRect(0,0,c.value,c.value),b){var D=void 0;P==="linear"?D=g.createLinearGradient(0,0,c.value,c.value):D=g.createRadialGradient(c.value/2,c.value/2,0,c.value/2,c.value/2,c.value/2),D.addColorStop(0,E),D.addColorStop(1,R),g.fillStyle=D}else g.fillStyle=S;$e?g.fill(new Path2D(_e(I,d.value))):I.forEach(function(C,l){C.forEach(function(u,_){u&&g.fillRect(_+d.value,l+d.value,1,1)})});var j=o.imageSettings.src&&x&&x.naturalWidth!==0&&x.naturalHeight!==0;if(j){var O=function(C,l,u,_,z,G){C.beginPath(),C.roundRect?C.roundRect(l,u,_,z,G):C.rect(l,u,_,z)};if(e.value){var U=e.value;g.fillStyle=o.background,O(g,U.x,U.y,U.width,U.height,U.borderRadius),g.fill()}var F=r.value.borderRadius;F>0?(g.save(),O(g,r.value.x,r.value.y,r.value.width,r.value.height,F),g.clip(),g.drawImage(x,r.value.x,r.value.y,r.value.width,r.value.height),g.restore()):g.drawImage(x,r.value.x,r.value.y,r.value.width,r.value.height)}}}};we(n),Re(n);var i=v.attrs.style;return function(){return N(Ce,[N("canvas",L(L({},v.attrs),{ref:t,style:L(L({},i),{width:"".concat(o.size,"px"),height:"".concat(o.size,"px")})})),o.imageSettings.src&&N("img",{ref:a,src:o.imageSettings.src,style:{display:"none"},onLoad:n})])}}}),Je=fe({name:"Qrcode",render:function(){var o=this.$props,v=o.renderAs,h=o.value,d=o.size,m=o.margin,c=o.level,r=o.background,e=o.foreground,t=o.imageSettings,a=o.gradient,n=o.gradientType,i=o.gradientStartColor,s=o.gradientEndColor;return N(v==="svg"?We:Xe,{value:h,size:d,margin:m,level:c,background:r,foreground:e,imageSettings:t,gradient:a,gradientType:n,gradientStartColor:i,gradientEndColor:s})},props:Ke});const Ze={class:"row items-center justify-between q-mb-lg"},je={class:"q-gutter-x-sm"},et={class:"row q-col-gutter-md q-mb-lg"},tt={class:"col-12 col-md-3"},at={class:"text-h4 text-weight-bold q-mt-xs"},rt={class:"row items-center no-wrap"},nt={class:"text-weight-bold"},ot={class:"text-caption text-grey-5"},lt={class:"text-h6"},it={class:"text-caption text-grey-6"},st={key:0},ut={class:"text-subtitle2 q-mb-sm"},dt={key:1,class:"text-center text-grey q-pa-md"},ct={id:"print-area",class:"print-area"},ft={class:"id-card-container shadow-2"},vt={class:"id-left"},ht={class:"text-weight-bold text-center",style:{"font-size":"12px","line-height":"1.2"}},mt={class:"text-center q-mt-xs",style:{"font-size":"10px",opacity:"0.8"}},gt={class:"id-right"},pt={class:"text-subtitle2 text-dark"},wt={class:"text-caption text-dark text-weight-medium"},Ct={class:"flex justify-end"},yt={__name:"StudentsPage",setup(o){const v=Oe(),h=Pe(),d=Ae(),m=Q(!1),c=Q(!1),r=Q(!1),e=Q({}),t=Q(!1),a=Q(!1),n=Q(null),i=Q([]),s=Q(null),p=Q("free"),S=C=>{s.value=C,r.value=!0},b=()=>{window.print()},P=[{name:"name",required:!0,label:"Student Name",align:"left",field:"name",sortable:!0},{name:"grade",align:"left",label:"Grade",field:"grade",sortable:!0},{name:"phone",align:"left",label:"Contact",field:"phone"},{name:"status",align:"left",label:"Status",field:"status",sortable:!0},{name:"actions",align:"right",label:"",field:"actions"}],E=Q([]),R=async()=>{a.value=!0;try{let C=J.from("students").select("*").order("created_at",{ascending:!1});const l=d.query.q;l&&(C=C.ilike("name",`%${l}%`));const{data:u,error:_}=await C;if(_)throw _;E.value=u}catch(C){v.notify({type:"negative",message:"Error fetching students: "+C.message})}finally{a.value=!1}};we(async()=>{await R();const{data:{user:C}}=await J.auth.getUser();if(C){const{data:l}=await J.from("profiles").select("plan_type").eq("id",C.id).single();l&&(p.value=l.plan_type||"free")}}),Ne(()=>d.query.q,async()=>{await R()});const M=()=>{if(p.value==="free"&&E.value.length>=10){v.dialog({title:"Plan Limit Reached",message:"You have reached the maximum of 10 students allowed on the Free plan. Upgrade to Growth or Pro.",ok:{label:"Upgrade Now",color:"secondary",push:!0},cancel:!0}).onOk(()=>{h.push("/subscription")});return}if(p.value==="growth"&&E.value.length>=100){v.dialog({title:"Growth Limit Reached",message:"You have reached the maximum of 100 students allowed on the Growth plan. Upgrade to Pro for unlimited access.",ok:{label:"Upgrade to Pro",color:"emerald",push:!0},cancel:!0}).onOk(()=>{h.push("/subscription")});return}e.value={status:"Active"},t.value=!1,m.value=!0},g=C=>{e.value={...C},t.value=!0,m.value=!0},I=async()=>{a.value=!0;try{const C={...e.value};t.value||delete C.id;const{data:{user:l}}=await J.auth.getUser();l&&(C.user_id=l.id);const{error:u}=await J.from("students").upsert(C).select();if(u)throw u;v.notify({type:"positive",message:t.value?"Student updated":"Student added"}),await R(),m.value=!1}catch(C){v.notify({type:"negative",message:"Error saving student: "+C.message})}finally{a.value=!1}},x=C=>{v.dialog({title:"Confirm Deletion",message:"Are you sure you want to remove this student? This action cannot be undone.",cancel:!0,persistent:!0,ok:{label:"Delete",color:"negative",flat:!0}}).onOk(async()=>{try{const{error:l}=await J.from("students").delete().eq("id",C);if(l)throw l;v.notify({type:"positive",message:"Student removed successfully",icon:"delete"}),await R()}catch(l){v.notify({type:"negative",message:"Error deleting student: "+l.message})}})},k=()=>{n.value=null,i.value=[],c.value=!0},B=()=>{pe("student_import_template.csv",`Name,Email,Phone,Grade
John Doe,john@example.com,0771234567,Grade 10
Jane Smith,jane@example.com,0717654321,Grade 11`,"text/csv")===!0?v.notify({type:"positive",message:"Template downloaded. Please fill and upload."}):v.notify({type:"negative",message:"Browser denied file download..."})},D=C=>{if(!C)return;const l=new FileReader;l.onload=u=>{const _=u.target.result;j(_)},l.readAsText(C)},j=C=>{const l=C.split(/\r\n|\n/).filter(z=>z.trim()!=="");if(l.length<2)return;const u=l[0].split(",").map(z=>z.trim().toLowerCase().replace(/^"|"$/g,"")),_=[];for(let z=1;z<l.length;z++){const G=l[z].split(",").map(W=>W.trim().replace(/^"|"$/g,""));if(G.length<u.length)continue;const H={};u.forEach((W,ne)=>{W.includes("name")&&(H.name=G[ne]),W.includes("email")&&(H.email=G[ne]),W.includes("phone")&&(H.phone=G[ne]),W.includes("grade")&&(H.grade=G[ne])}),H.status="Active",H.name&&_.push(H)}i.value=_},O=async()=>{if(i.value.length===0)return;a.value=!0;let C=Math.max(0,...E.value.map(u=>u.id))+1;const l=i.value.map((u,_)=>({id:C+_,...u}));E.value.push(...l),a.value=!1,c.value=!1,v.notify({type:"positive",message:`Successfully imported ${l.length} students`}),i.value=[],n.value=null},U=C=>{i.value.splice(C,1)},F=()=>{const C=["Name,Email,Phone,Grade,Status",...E.value.map(u=>`"${u.name}","${u.email||""}","${u.phone||""}","${u.grade||""}","${u.status}"`)].join(`
`);pe("students_export.csv",C,"text/csv")||v.notify({type:"negative",message:"Browser denied file download..."})};return(C,l)=>(q(),ee(Fe,{class:"q-pa-lg"},{default:w(()=>[y("div",Ze,[l[9]||(l[9]=y("div",null,[y("h1",{class:"text-h5 text-weight-bold q-my-none"},"Students"),y("p",{class:"text-grey-5 q-mt-xs q-mb-none"},"Manage student enrollments and details.")],-1)),y("div",je,[f(T,{outline:"",icon:"filter_list",label:"Filter","no-caps":""}),f(T,{unelevated:"",icon:"add",color:"primary",label:"New Student","no-caps":"",onClick:M}),f(T,{unelevated:"",color:"secondary",icon:"upload_file",label:"Import CSV","no-caps":"",onClick:k}),f(T,{outline:"",color:"primary",icon:"download",label:"Export","no-caps":"",onClick:F})])]),y("div",et,[y("div",tt,[f(te,{class:"no-shadow border-gray q-pa-md"},{default:w(()=>[l[10]||(l[10]=y("div",{class:"text-caption text-grey-5 text-uppercase text-weight-bold"},"Total Students",-1)),y("div",at,A(E.value.length),1)]),_:1})])]),f(te,{class:"no-shadow border-gray"},{default:w(()=>[f(Te,{rows:E.value,columns:P,"row-key":"id",flat:"",bordered:"",pagination:{rowsPerPage:10}},{"body-cell-name":w(u=>[f(ce,{props:u},{default:w(()=>[y("div",rt,[f(Ie,{size:"32px",class:"q-mr-sm",color:"blue-1","text-color":"primary"},{default:w(()=>[V(A(u.row.name.charAt(0)),1)]),_:2},1024),y("div",null,[y("div",nt,A(u.row.name),1),y("div",ot,A(u.row.email),1)])])]),_:2},1032,["props"])]),"body-cell-status":w(u=>[f(ce,{props:u},{default:w(()=>[f(ze,{color:u.row.status==="Active"?"green-2":"red-2","text-color":u.row.status==="Active"?"green-9":"red-9",class:"q-px-sm q-py-xs text-weight-bold"},{default:w(()=>[V(A(u.row.status),1)]),_:2},1032,["color","text-color"])]),_:2},1032,["props"])]),"body-cell-actions":w(u=>[f(ce,{props:u,"auto-width":""},{default:w(()=>[f(T,{flat:"",round:"",dense:"",icon:"more_vert",color:"grey-5"},{default:w(()=>[f(Le,{class:"text-dark"},{default:w(()=>[f(he,{style:{"min-width":"140px"}},{default:w(()=>[$((q(),ee(oe,{clickable:"",onClick:_=>g(u.row)},{default:w(()=>[f(ae,null,{default:w(()=>[...l[11]||(l[11]=[V("Edit Details",-1)])]),_:1})]),_:1},8,["onClick"])),[[Y]]),$((q(),ee(oe,{clickable:"",onClick:_=>S(u.row)},{default:w(()=>[f(ae,null,{default:w(()=>[...l[12]||(l[12]=[V("Generate ID Card",-1)])]),_:1})]),_:1},8,["onClick"])),[[Y]]),f(le),$((q(),ee(oe,{clickable:"",class:"text-red",onClick:_=>x(u.row.id)},{default:w(()=>[f(ae,null,{default:w(()=>[...l[13]||(l[13]=[V("Delete",-1)])]),_:1})]),_:1},8,["onClick"])),[[Y]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1}),f(ie,{modelValue:m.value,"onUpdate:modelValue":l[5]||(l[5]=u=>m.value=u)},{default:w(()=>[f(te,{style:{"min-width":"400px"}},{default:w(()=>[f(Z,null,{default:w(()=>[y("div",lt,A(t.value?"Edit Student Details":"Add New Student"),1)]),_:1}),f(Z,{class:"q-pt-none q-gutter-y-md"},{default:w(()=>[f(se,{outlined:"",modelValue:e.value.name,"onUpdate:modelValue":l[0]||(l[0]=u=>e.value.name=u),label:"Student Name",dense:""},null,8,["modelValue"]),f(se,{outlined:"",modelValue:e.value.email,"onUpdate:modelValue":l[1]||(l[1]=u=>e.value.email=u),label:"Email Address",dense:""},null,8,["modelValue"]),f(se,{outlined:"",modelValue:e.value.phone,"onUpdate:modelValue":l[2]||(l[2]=u=>e.value.phone=u),label:"Phone Number",mask:"###-#######",dense:""},null,8,["modelValue"]),f(me,{outlined:"",modelValue:e.value.grade,"onUpdate:modelValue":l[3]||(l[3]=u=>e.value.grade=u),options:["Grade 6","Grade 7","Grade 8","Grade 9","Grade 10","Grade 11","Grade 12","Grade 13"],label:"Grade",dense:""},null,8,["modelValue"]),f(me,{outlined:"",modelValue:e.value.status,"onUpdate:modelValue":l[4]||(l[4]=u=>e.value.status=u),options:["Active","Inactive"],label:"Status",dense:""},null,8,["modelValue"])]),_:1}),f(ue,{align:"right",class:"text-primary q-pa-md"},{default:w(()=>[$(f(T,{flat:"",label:"Cancel",color:"grey"},null,512),[[Y]]),$(f(T,{unelevated:"",label:t.value?"Save Changes":"Add Student",color:"primary",onClick:I},null,8,["label"]),[[Y]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),f(ie,{modelValue:c.value,"onUpdate:modelValue":l[7]||(l[7]=u=>c.value=u),persistent:""},{default:w(()=>[f(te,{style:{"min-width":"600px"}},{default:w(()=>[f(Z,null,{default:w(()=>[l[15]||(l[15]=y("div",{class:"text-h6"},"Import Students from CSV",-1)),y("div",it,[l[14]||(l[14]=V(" Upload a CSV file with columns: Name, Email, Phone, Grade. ",-1)),y("a",{href:"#",class:"text-primary cursor-pointer",onClick:xe(B,["prevent"])},"Download Template")])]),_:1}),f(Z,{class:"q-pt-none q-gutter-y-md"},{default:w(()=>[f(Be,{outlined:"",modelValue:n.value,"onUpdate:modelValue":[l[6]||(l[6]=u=>n.value=u),D],label:"Select CSV File",accept:".csv"},{prepend:w(()=>[f(Qe,{name:"attach_file"})]),_:1},8,["modelValue"]),f(le),i.value.length>0?(q(),de("div",st,[y("div",ut," Preview ("+A(i.value.length)+" students found) ",1),f(Ue,{style:{height:"200px",border:"1px solid #ddd","border-radius":"4px"}},{default:w(()=>[f(he,{separator:""},{default:w(()=>[(q(!0),de(Ce,null,ke(i.value,(u,_)=>(q(),ee(oe,{key:_},{default:w(()=>[f(ae,null,{default:w(()=>[f(ge,null,{default:w(()=>[V(A(u.name),1)]),_:2},1024),f(ge,{caption:""},{default:w(()=>[V(A(u.grade)+" | "+A(u.email)+" | "+A(u.phone),1)]),_:2},1024)]),_:2},1024),f(ae,{side:""},{default:w(()=>[f(T,{flat:"",round:"",dense:"",icon:"close",color:"red",onClick:z=>U(_)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):n.value?(q(),de("div",dt," No valid data found in file. Please checks your CSV format. ")):De("",!0)]),_:1}),f(ue,{align:"right",class:"text-primary q-pa-md"},{default:w(()=>[$(f(T,{flat:"",label:"Cancel",color:"grey"},null,512),[[Y]]),f(T,{unelevated:"",label:"Import Students",color:"primary",disable:i.value.length===0,loading:a.value,onClick:O},null,8,["disable","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),f(ie,{modelValue:r.value,"onUpdate:modelValue":l[8]||(l[8]=u=>r.value=u)},{default:w(()=>[f(te,{style:{"min-width":"400px"}},{default:w(()=>[f(Z,null,{default:w(()=>[...l[16]||(l[16]=[y("div",{class:"text-h6"},"Student ID Card",-1)])]),_:1}),f(Z,{class:"flex flex-center q-py-lg bg-grey-2"},{default:w(()=>[y("div",ct,[y("div",ft,[y("div",vt,[l[17]||(l[17]=y("img",{src:"https://cdn.quasar.dev/img/boy-avatar.png",class:"student-photo",alt:"Student"},null,-1)),y("div",ht,A(s.value?.name),1),y("div",mt,A(s.value?.grade),1)]),y("div",gt,[y("div",null,[l[18]||(l[18]=y("div",{class:"text-h6 text-primary text-weight-bold",style:{"line-height":"1"}}," DIGYNEX ",-1)),l[19]||(l[19]=y("div",{class:"text-caption text-grey-8",style:{"font-size":"10px"}}," Institute of Higher Education ",-1)),f(le,{class:"q-my-sm"}),l[20]||(l[20]=y("div",{class:"text-caption text-grey-6",style:{"font-size":"10px"}},"ID Number",-1)),y("div",pt,A(s.value?.id),1),l[21]||(l[21]=y("div",{class:"text-caption text-grey-6 q-mt-xs",style:{"font-size":"10px"}}," Contact ",-1)),y("div",wt,A(s.value?.phone),1)]),y("div",Ct,[f(Je,{value:String(s.value?.id),size:60,level:"H"},null,8,["value"])])])])])]),_:1}),f(ue,{align:"right",class:"text-primary q-pa-md"},{default:w(()=>[$(f(T,{flat:"",label:"Close",color:"grey"},null,512),[[Y]]),f(T,{unelevated:"",label:"Print Card",icon:"print",color:"primary",onClick:b})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},Gt=qe(yt,[["__scopeId","data-v-64b78b06"]]);export{Gt as default};
